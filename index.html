<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Focus Timer + Quick Tasks</title>
<style>
:root {
    --bg1:#020304;
    --bg2:#0a0c0d;
    --card:#111315;
    --ink:#e7ecef;
    --muted:#6b7280;
    --line:#1e2327;
    --accent:#00c26f;     /* robinhood green */
    --accent-2:#10b981;
    --danger:#f87171;
    --radius:16px;
    --shadow:0 8px 25px rgba(0,0,0,.45);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(180deg,var(--bg1),var(--bg2));
    color:var(--ink);
    font-family:"Inter",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
    display:grid; place-items:start; padding:28px;
  }
  .app{width:100%; max-width:960px; margin:0 auto; display:grid; gap:22px}
  header{display:flex; align-items:center; justify-content:space-between; gap:12px}
  .title{font-weight:800; font-size:clamp(22px,3.5vw,30px); letter-spacing:.3px}
  .sub{color:var(--muted); font-size:14px}
  .card{
    background:var(--card); border:1px solid var(--line);
    border-radius:var(--radius); box-shadow:var(--shadow); padding:18px;
  }
  .timer{display:grid; grid-template-columns:1fr 1fr; gap:18px}
  @media (max-width:880px){ .timer{grid-template-columns:1fr} }
  .ringWrap{display:grid; place-items:center; position:relative; padding:8px}
  .time{position:absolute; font-weight:800; font-size:clamp(36px,9vw,64px)}
  .controls,.presets{display:flex; flex-wrap:wrap; gap:10px; align-items:center}
  button,.chip{
    appearance:none; background:#1a1d20; color:var(--ink);
    border:1px solid var(--line); border-radius:12px;
    padding:10px 14px; cursor:pointer; font-weight:600;
    transition:background .15s ease,border-color .15s ease,transform .06s ease;
  }
  button:hover,.chip:hover{background:#23282b}
  button:active,.chip:active{transform:translateY(1px)}
  button.primary{background:var(--accent); border-color:var(--accent); color:#000; font-weight:700}
  button.primary:hover{filter:brightness(1.1)}
  button.danger{background:var(--danger); border-color:var(--danger); color:#000}
  button.ghost{background:transparent}
  .presets .chip.active{background:var(--accent-2); border-color:var(--accent-2); color:#000}
  input[type="text"],input[type="number"],textarea{
    width:100%; padding:12px 14px; border-radius:12px;
    background:#0c0f10; color:var(--ink); border:1px solid var(--line); outline:none;
  }
  input[type="text"]:focus,input[type="number"]:focus,textarea:focus{
    border-color:var(--accent); box-shadow:0 0 0 3px rgba(0,194,111,.2);
  }
  .grid{display:grid; grid-template-columns:1.4fr 1fr; gap:18px}
  @media (max-width:1000px){ .grid{grid-template-columns:1fr} }
  .taskRow{display:grid; grid-template-columns:1fr auto; gap:8px; margin-top:8px}
  .taskItem{
    display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:10px;
    padding:10px 12px; border-radius:12px; background:#0c0f10; border:1px solid var(--line);
  }
  .taskItem.done{opacity:.6; text-decoration:line-through}
  .checkbox{width:18px;height:18px;accent-color:var(--accent)}
  .muted{color:var(--muted);font-size:13px}
  .small{font-size:12px}
  .tog{display:inline-flex;align-items:center;gap:8px}
  a.link{color:var(--accent);text-decoration:none;border-bottom:1px dashed rgba(0,194,111,.5)}
  footer{color:var(--muted);text-align:center;font-size:12px}

  /* Quote Section */
  .quoteJokeRow {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 18px;
  }
  @media (max-width: 880px) {
    .quoteJokeRow {
      grid-template-columns: 1fr;
    }
  }
  .quoteCard, .jokeCard {
    text-align: center;
    padding: 24px;
  }
  .quoteText {
    font-size: 18px;
    font-weight: 600;
    font-style: italic;
    line-height: 1.6;
    color: var(--ink);
    margin-bottom: 12px;
  }
  .quoteAuthor {
    color: var(--muted);
    font-size: 14px;
    margin-bottom: 16px;
  }
  .newQuoteBtn, .newJokeBtn {
    font-size: 13px;
    padding: 8px 16px;
  }
  .jokeText {
    font-size: 16px;
    line-height: 1.6;
    color: var(--ink);
    margin-bottom: 16px;
    min-height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Tabs */
  .tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 22px;
    border-bottom: 2px solid var(--line);
    padding-bottom: 0;
  }
  .tab {
    padding: 12px 24px;
    background: transparent;
    border: none;
    border-bottom: 3px solid transparent;
    color: var(--muted);
    cursor: pointer;
    font-weight: 600;
    font-size: 15px;
    transition: all 0.2s ease;
    margin-bottom: -2px;
  }
  .tab:hover {
    color: var(--ink);
    background: rgba(255, 255, 255, 0.03);
  }
  .tab.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
  }
  .tabContent {
    display: none;
  }
  .tabContent.active {
    display: grid;
    gap: 22px;
  }

  /* Games */
  .gamesGrid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 18px;
  }
  @media (max-width: 880px) {
    .gamesGrid {
      grid-template-columns: 1fr;
    }
  }
  .gameCard {
    padding: 24px;
    min-height: 300px;
    display: flex;
    flex-direction: column;
  }
  .gameTitle {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 8px;
  }
  .gameDesc {
    color: var(--muted);
    font-size: 13px;
    margin-bottom: 16px;
  }
  .gameArea {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 16px;
  }

  /* Memory Game */
  .memoryGrid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    max-width: 280px;
  }
  .memoryCard {
    aspect-ratio: 1;
    background: #1a1d20;
    border: 2px solid var(--line);
    border-radius: 8px;
    cursor: pointer;
    display: grid;
    place-items: center;
    font-size: 24px;
    transition: all 0.3s ease;
  }
  .memoryCard:hover:not(.flipped):not(.matched) {
    background: #23282b;
    transform: scale(1.05);
  }
  .memoryCard.flipped, .memoryCard.matched {
    background: var(--accent-2);
    border-color: var(--accent);
  }
  .memoryCard.matched {
    opacity: 0.6;
  }

  /* Reaction Game */
  .reactionBox {
    width: 100%;
    max-width: 300px;
    height: 200px;
    background: #1a1d20;
    border: 2px solid var(--line);
    border-radius: 12px;
    display: grid;
    place-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    padding: 20px;
  }
  .reactionBox.waiting {
    background: var(--danger);
    border-color: var(--danger);
  }
  .reactionBox.ready {
    background: var(--accent);
    border-color: var(--accent);
    color: #000;
  }
  .reactionBox:hover {
    transform: scale(1.02);
  }
  .reactionScore {
    font-size: 14px;
    color: var(--muted);
  }
</style>
</head>
<body>
  <div class="app">
    <header>
      <div>
        <div class="title">Focus Timer + Quick Tasks</div>
        <div class="sub">A no-login, one-page productivity tool. Your data saves in your browser.</div>
      </div>
      <div class="tog">
        <input id="soundToggle" type="checkbox" />
        <label for="soundToggle" class="small">Chime on session end</label>
      </div>
    </header>

    <!-- Tab Navigation -->
    <div class="tabs">
      <button class="tab active" data-tab="focus">Focus & Productivity</button>
      <button class="tab" data-tab="games">Mini Games</button>
    </div>

    <!-- Focus Tab Content -->
    <div id="focusTab" class="tabContent active">
      <div class="quoteJokeRow">
      <section class="card quoteCard">
        <div class="quoteText" id="quoteText">"The secret of getting ahead is getting started."</div>
        <div class="quoteAuthor" id="quoteAuthor">â€” Mark Twain</div>
        <button class="ghost newQuoteBtn" id="newQuoteBtn">New Quote</button>
      </section>

      <section class="card jokeCard">
        <div class="jokeText" id="jokeText">Why don't programmers like nature? It has too many bugs!</div>
        <button class="ghost newJokeBtn" id="newJokeBtn">New Joke</button>
      </section>
    </div>

    <section class="card timer">
      <div class="ringWrap">
        <svg width="260" height="260" viewBox="0 0 120 120" style="position: relative;">
          <circle cx="60" cy="60" r="52" stroke="rgba(255,255,255,.12)" stroke-width="8" fill="none"/>
          <circle id="progress" cx="60" cy="60" r="52" stroke="url(#g)" stroke-width="8" stroke-linecap="round" fill="none"
                  transform="rotate(-90 60 60)" stroke-dasharray="327" stroke-dashoffset="327"/>
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#7c5cff"></stop>
              <stop offset="100%" stop-color="#33d6a6"></stop>
            </linearGradient>
          </defs>
        </svg>
        <div class="time" id="time">25:00</div>
      </div>

      <div>
        <div class="presets" style="margin-bottom:12px;">
          <button class="chip active" data-mins="25">Pomodoro 25</button>
          <button class="chip" data-mins="5">Short Break 5</button>
          <button class="chip" data-mins="15">Long Break 15</button>
          <span class="spacer"></span>
          <label class="muted small">Custom:</label>
          <input id="customMins" type="number" min="1" max="180" value="25" style="width:84px;" />
          <button class="chip" id="applyCustom">Set</button>
        </div>
        <div class="controls" style="margin-bottom:12px;">
          <button id="startBtn" class="primary">Start</button>
          <button id="pauseBtn" class="ghost">Pause</button>
          <button id="resetBtn" class="danger">Reset</button>
        </div>
        <div class="muted small">
          Tip: switch presets anytimeâ€”progress resets to match the selected length.
        </div>
      </div>
    </section>

    <section class="grid">
      <div class="card">
        <strong>Quick Tasks</strong>
        <div class="taskRow">
          <input id="taskInput" type="text" placeholder="Add a task and press Enterâ€¦" />
          <button id="addTask">Add</button>
        </div>
        <div id="taskList" style="display:grid; gap:8px; margin-top:12px;"></div>
        <div class="foot">
          <span class="muted small">Tasks save automatically.</span>
          <div>
            <button id="clearDone" class="ghost small">Clear done</button>
            <button id="clearAll" class="ghost small">Clear all</button>
          </div>
        </div>
      </div>

      <div class="card">
        <strong>Session Notes</strong>
        <textarea id="notes" rows="9" placeholder="Jot down what youâ€™re focusing onâ€¦" style="width:100%; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background:#151935; color:var(--fg);"></textarea>
        <div class="foot">
          <span class="muted small">Notes auto-save locally.</span>
          <a id="downloadNotes" href="#" class="link small">Download .txt</a>
        </div>
        <div class="muted small warn">No accounts, no tracking, just your browser.</div>
      </div>
    </section>
    </div>

    <!-- Games Tab Content -->
    <div id="gamesTab" class="tabContent">
      <div class="gamesGrid">
        <!-- Memory Card Game -->
        <section class="card gameCard">
          <div class="gameTitle">Memory Match</div>
          <div class="gameDesc">Find all matching pairs of emojis</div>
          <div class="gameArea">
            <div class="memoryGrid" id="memoryGrid"></div>
            <div>
              <div class="reactionScore">Moves: <span id="memoryMoves">0</span> | Matches: <span id="memoryMatches">0</span>/8</div>
              <button class="ghost small" id="resetMemory" style="margin-top: 12px;">Reset Game</button>
            </div>
          </div>
        </section>

        <!-- Reaction Time Game -->
        <section class="card gameCard">
          <div class="gameTitle">Reaction Timer</div>
          <div class="gameDesc">Test your reaction speed!</div>
          <div class="gameArea">
            <div class="reactionBox" id="reactionBox">
              Click to Start
            </div>
            <div class="reactionScore">
              <div id="reactionResult">Best Time: <span id="bestTime">-</span>ms</div>
              <div style="margin-top: 4px; font-size: 12px;">Average: <span id="avgTime">-</span>ms</div>
            </div>
          </div>
        </section>
      </div>
    </div>

  </div>

<script>
(() => {
  // ---------- Utilities ----------
  const $ = (sel, ctx=document) => ctx.querySelector(sel);
  const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));
  const store = {
    get(key, fallback) {
      try { return JSON.parse(localStorage.getItem(key)) ?? fallback; }
      catch { return fallback; }
    },
    set(key, val) { localStorage.setItem(key, JSON.stringify(val)); }
  };

  // ---------- Timer State ----------
  let totalSecs = 25*60;
  let remaining = totalSecs;
  let tickId = null;
  const ring = $('#progress');
  const timeEl = $('#time');
  const dash = 2 * Math.PI * 52; // circumference â‰ˆ 327
  ring.setAttribute('stroke-dasharray', dash);

  function format(ms) {
    const m = Math.floor(ms/60);
    const s = ms % 60;
    return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  }
  function render() {
    timeEl.textContent = format(remaining);
    const ratio = 1 - (remaining / totalSecs);
    ring.setAttribute('stroke-dashoffset', String((1 - ratio) * dash));
  }
  function setLength(mins) {
    mins = Math.max(1, Math.min(180, Number(mins)||25));
    totalSecs = mins * 60;
    remaining = totalSecs;
    render();
    $('#customMins').value = mins;
    $$('.presets .chip').forEach(c => c.classList.toggle('active', c.dataset.mins == mins));
    pause();
  }
  function start() {
    if (tickId) return;
    const startAt = Date.now();
    let last = startAt;
    tickId = setInterval(() => {
      const now = Date.now();
      const delta = Math.floor((now - last)/1000);
      if (delta >= 1) {
        remaining = Math.max(0, remaining - delta);
        last = now;
        render();
        if (remaining <= 0) {
          pause();
          chime();
        }
      }
    }, 250);
  }
  function pause() { clearInterval(tickId); tickId = null; }
  function reset() { remaining = totalSecs; render(); pause(); }
  function chime() {
    if (!$('#soundToggle').checked) return;
    try {
      const ctx = new (window.AudioContext || window.webkitAudioContext)();
      const o = ctx.createOscillator(); const g = ctx.createGain();
      o.type = "sine"; o.frequency.value = 880;
      o.connect(g); g.connect(ctx.destination);
      g.gain.setValueAtTime(0.001, ctx.currentTime);
      g.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime + 0.02);
      g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 1.0);
      o.start(); o.stop(ctx.currentTime + 1.0);
    } catch {}
  }

  // ---------- Presets ----------
  $$('.presets .chip[data-mins]').forEach(btn => {
    btn.addEventListener('click', () => setLength(Number(btn.dataset.mins)));
  });
  $('#applyCustom').addEventListener('click', () => setLength($('#customMins').value));
  $('#startBtn').addEventListener('click', start);
  $('#pauseBtn').addEventListener('click', pause);
  $('#resetBtn').addEventListener('click', reset);

  // ---------- Tasks ----------
  function renderTasks() {
    const tasks = store.get('tasks', []);
    const list = $('#taskList');
    list.innerHTML = '';
    tasks.forEach((t, i) => {
      const row = document.createElement('div'); row.className = 'taskItem' + (t.done?' done':'');
      const cb = document.createElement('input'); cb.type = 'checkbox'; cb.className='checkbox'; cb.checked = !!t.done;
      cb.addEventListener('change', () => { tasks[i].done = cb.checked; store.set('tasks', tasks); renderTasks(); });
      const label = document.createElement('div'); label.textContent = t.text;
      const del = document.createElement('button'); del.className='ghost small'; del.textContent='Delete';
      del.addEventListener('click', () => { tasks.splice(i,1); store.set('tasks', tasks); renderTasks(); });
      row.append(cb, label, del);
      list.append(row);
    });
  }
  function addTaskFromInput() {
    const v = $('#taskInput').value.trim();
    if (!v) return;
    const tasks = store.get('tasks', []);
    tasks.unshift({ text: v, done: false });
    store.set('tasks', tasks);
    $('#taskInput').value = '';
    renderTasks();
  }
  $('#addTask').addEventListener('click', addTaskFromInput);
  $('#taskInput').addEventListener('keydown', e => { if (e.key === 'Enter') addTaskFromInput(); });
  $('#clearDone').addEventListener('click', () => {
    const tasks = store.get('tasks', []).filter(t => !t.done); store.set('tasks', tasks); renderTasks();
  });
  $('#clearAll').addEventListener('click', () => {
    if (!confirm('Clear ALL tasks?')) return;
    store.set('tasks', []); renderTasks();
  });

  // ---------- Notes ----------
  const notes = $('#notes');
  notes.value = store.get('notes', '');
  notes.addEventListener('input', () => store.set('notes', notes.value));
  $('#downloadNotes').addEventListener('click', (e) => {
    e.preventDefault();
    const blob = new Blob([notes.value], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = `focus-notes-${new Date().toISOString().slice(0,10)}.txt`;
    document.body.appendChild(a); a.click(); a.remove();
    setTimeout(() => URL.revokeObjectURL(url), 500);
  });

  // ---------- Settings ----------
  const saved = store.get('settings', { mins: 25, sound: false });
  $('#soundToggle').checked = !!saved.sound;
  setLength(saved.mins || 25);
  renderTasks();
  render();

  // Persist some state when leaving
  window.addEventListener('beforeunload', () => {
    store.set('settings', { mins: totalSecs/60, sound: $('#soundToggle').checked });
  });

  // ---------- Random Quote Generator ----------
  const quotes = [
    { text: "The secret of getting ahead is getting started.", author: "Mark Twain" },
    { text: "It does not matter how slowly you go as long as you do not stop.", author: "Confucius" },
    { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
    { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
    { text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
    { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
    { text: "The future depends on what you do today.", author: "Mahatma Gandhi" },
    { text: "Focus on being productive instead of busy.", author: "Tim Ferriss" },
    { text: "You don't have to be great to start, but you have to start to be great.", author: "Zig Ziglar" },
    { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" },
    { text: "Productivity is never an accident. It is always the result of a commitment to excellence.", author: "Paul J. Meyer" },
    { text: "Concentrate all your thoughts upon the work in hand. The sun's rays do not burn until brought to a focus.", author: "Alexander Graham Bell" },
    { text: "You may delay, but time will not.", author: "Benjamin Franklin" },
    { text: "Action is the foundational key to all success.", author: "Pablo Picasso" },
    { text: "The only limit to our realization of tomorrow will be our doubts of today.", author: "Franklin D. Roosevelt" },
    { text: "Start where you are. Use what you have. Do what you can.", author: "Arthur Ashe" },
    { text: "Either you run the day or the day runs you.", author: "Jim Rohn" },
    { text: "Time is what we want most, but what we use worst.", author: "William Penn" },
    { text: "The key is not to prioritize what's on your schedule, but to schedule your priorities.", author: "Stephen Covey" },
    { text: "Amateurs sit and wait for inspiration, the rest of us just get up and go to work.", author: "Stephen King" }
  ];

  const quoteText = $('#quoteText');
  const quoteAuthor = $('#quoteAuthor');
  const newQuoteBtn = $('#newQuoteBtn');

  function displayRandomQuote() {
    const randomIndex = Math.floor(Math.random() * quotes.length);
    const quote = quotes[randomIndex];
    quoteText.textContent = `"${quote.text}"`;
    quoteAuthor.textContent = `â€” ${quote.author}`;
  }

  newQuoteBtn.addEventListener('click', displayRandomQuote);

  // ---------- Random Joke Generator ----------
  const jokes = [
    "Why don't programmers like nature? It has too many bugs!",
    "Why did the developer go broke? Because he used up all his cache!",
    "How many programmers does it take to change a light bulb? None, that's a hardware problem.",
    "Why do Java developers wear glasses? Because they don't C#!",
    "What's a programmer's favorite hangout place? The Foo Bar!",
    "Why did the scarecrow win an award? He was outstanding in his field!",
    "What do you call a bear with no teeth? A gummy bear!",
    "Why don't scientists trust atoms? Because they make up everything!",
    "What did the ocean say to the beach? Nothing, it just waved!",
    "Why did the bicycle fall over? It was two-tired!",
    "What do you call fake spaghetti? An impasta!",
    "How does a penguin build its house? Igloos it together!",
    "Why don't eggs tell jokes? They'd crack each other up!",
    "What do you call a fish wearing a bowtie? Sofishticated!",
    "Why did the math book look so sad? Because it had too many problems!",
    "What do you call a can opener that doesn't work? A can't opener!",
    "Why did the coffee file a police report? It got mugged!",
    "What's the best time to go to the dentist? Tooth hurty!",
    "Why don't skeletons fight each other? They don't have the guts!",
    "What did one wall say to the other wall? I'll meet you at the corner!"
  ];

  const jokeText = $('#jokeText');
  const newJokeBtn = $('#newJokeBtn');

  function displayRandomJoke() {
    const randomIndex = Math.floor(Math.random() * jokes.length);
    jokeText.textContent = jokes[randomIndex];
  }

  newJokeBtn.addEventListener('click', displayRandomJoke);

  // ---------- Tab Switching ----------
  const tabs = $$('.tab');
  const tabContents = $$('.tabContent');

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      const targetTab = tab.dataset.tab;

      // Update active tab
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');

      // Update active content
      tabContents.forEach(content => content.classList.remove('active'));
      const targetContent = $(`#${targetTab}Tab`);
      if (targetContent) targetContent.classList.add('active');
    });
  });

  // ---------- Memory Card Game ----------
  const emojis = ['ðŸŽ®', 'ðŸŽ¯', 'ðŸŽ¨', 'ðŸŽ­', 'ðŸŽª', 'ðŸŽ¸', 'ðŸŽº', 'ðŸŽ»'];
  let memoryCards = [];
  let flippedCards = [];
  let matchedPairs = 0;
  let moves = 0;

  function initMemoryGame() {
    const memoryGrid = $('#memoryGrid');
    memoryGrid.innerHTML = '';

    // Create pairs and shuffle
    memoryCards = [...emojis, ...emojis]
      .sort(() => Math.random() - 0.5)
      .map((emoji, index) => ({ emoji, index, matched: false }));

    // Create card elements
    memoryCards.forEach((card, i) => {
      const cardEl = document.createElement('div');
      cardEl.className = 'memoryCard';
      cardEl.dataset.index = i;
      cardEl.addEventListener('click', () => flipCard(i, cardEl));
      memoryGrid.appendChild(cardEl);
    });

    flippedCards = [];
    matchedPairs = 0;
    moves = 0;
    updateMemoryScore();
  }

  function flipCard(index, cardEl) {
    if (flippedCards.length >= 2 || cardEl.classList.contains('flipped') || cardEl.classList.contains('matched')) {
      return;
    }

    cardEl.classList.add('flipped');
    cardEl.textContent = memoryCards[index].emoji;
    flippedCards.push({ index, cardEl });

    if (flippedCards.length === 2) {
      moves++;
      updateMemoryScore();

      setTimeout(() => {
        const [first, second] = flippedCards;

        if (memoryCards[first.index].emoji === memoryCards[second.index].emoji) {
          // Match found
          first.cardEl.classList.add('matched');
          second.cardEl.classList.add('matched');
          memoryCards[first.index].matched = true;
          memoryCards[second.index].matched = true;
          matchedPairs++;
          updateMemoryScore();

          if (matchedPairs === emojis.length) {
            setTimeout(() => alert(`You won in ${moves} moves!`), 300);
          }
        } else {
          // No match
          first.cardEl.classList.remove('flipped');
          second.cardEl.classList.remove('flipped');
          first.cardEl.textContent = '';
          second.cardEl.textContent = '';
        }

        flippedCards = [];
      }, 800);
    }
  }

  function updateMemoryScore() {
    $('#memoryMoves').textContent = moves;
    $('#memoryMatches').textContent = matchedPairs;
  }

  $('#resetMemory')?.addEventListener('click', initMemoryGame);
  initMemoryGame();

  // ---------- Reaction Time Game ----------
  let reactionState = 'idle';
  let reactionStartTime = 0;
  let reactionTimeout = null;
  let reactionTimes = [];
  let bestReactionTime = Infinity;

  const reactionBox = $('#reactionBox');

  function startReaction() {
    if (reactionState !== 'idle') return;

    reactionState = 'waiting';
    reactionBox.textContent = 'Wait for green...';
    reactionBox.classList.add('waiting');
    reactionBox.classList.remove('ready');

    // Random delay between 2-5 seconds
    const delay = 2000 + Math.random() * 3000;

    reactionTimeout = setTimeout(() => {
      reactionState = 'ready';
      reactionBox.textContent = 'CLICK NOW!';
      reactionBox.classList.remove('waiting');
      reactionBox.classList.add('ready');
      reactionStartTime = Date.now();
    }, delay);
  }

  function handleReactionClick() {
    if (reactionState === 'idle') {
      startReaction();
    } else if (reactionState === 'waiting') {
      // Clicked too early
      clearTimeout(reactionTimeout);
      reactionState = 'idle';
      reactionBox.classList.remove('waiting');
      reactionBox.textContent = 'Too early! Click to try again';
    } else if (reactionState === 'ready') {
      // Calculate reaction time
      const reactionTime = Date.now() - reactionStartTime;
      reactionTimes.push(reactionTime);

      if (reactionTime < bestReactionTime) {
        bestReactionTime = reactionTime;
      }

      // Calculate average
      const avg = Math.round(reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length);

      reactionState = 'idle';
      reactionBox.classList.remove('ready');
      reactionBox.textContent = `${reactionTime}ms! Click to try again`;

      $('#bestTime').textContent = bestReactionTime;
      $('#avgTime').textContent = avg;
    }
  }

  reactionBox?.addEventListener('click', handleReactionClick);
})();
</script>
</body>
</html>

