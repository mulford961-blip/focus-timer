<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Focus Timer + Quick Tasks</title>
<style>
:root {
    --bg1:#020304;
    --bg2:#0a0c0d;
    --card:#111315;
    --ink:#e7ecef;
    --muted:#6b7280;
    --line:#1e2327;
    --accent:#00c26f;     /* robinhood green */
    --accent-2:#10b981;
    --danger:#f87171;
    --radius:16px;
    --shadow:0 8px 25px rgba(0,0,0,.45);
  }

  /* Light Theme */
  [data-theme="light"] {
    --bg1:#f8fafc;
    --bg2:#e2e8f0;
    --card:#ffffff;
    --ink:#1e293b;
    --muted:#64748b;
    --line:#e2e8f0;
    --accent:#00c26f;
    --accent-2:#10b981;
    --danger:#ef4444;
    --shadow:0 8px 25px rgba(0,0,0,.08);
  }

  *{box-sizing:border-box}
  html,body{height:100%; transition:background-color .3s ease, color .3s ease}
  body{
    margin:0; background:linear-gradient(180deg,var(--bg1),var(--bg2));
    color:var(--ink);
    font-family:"Inter",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
    display:grid; place-items:start; padding:28px;
  }
  .app{width:100%; max-width:960px; margin:0 auto; display:grid; gap:22px}
  header{display:flex; align-items:center; justify-content:space-between; gap:12px}
  .title{font-weight:800; font-size:clamp(22px,3.5vw,30px); letter-spacing:.3px}
  .sub{color:var(--muted); font-size:14px}
  .card{
    background:var(--card); border:1px solid var(--line);
    border-radius:var(--radius); box-shadow:var(--shadow); padding:18px;
    transition:box-shadow .3s ease, border-color .3s ease;
  }
  .card:hover {
    box-shadow:0 12px 35px rgba(0,0,0,.15);
  }
  .timer{display:grid; grid-template-columns:1fr 1fr; gap:18px}
  @media (max-width:880px){ .timer{grid-template-columns:1fr} }
  .ringWrap{display:grid; place-items:center; position:relative; padding:8px}
  .time{position:absolute; font-weight:800; font-size:clamp(36px,9vw,64px)}
  .controls,.presets{display:flex; flex-wrap:wrap; gap:10px; align-items:center}
  button,.chip{
    appearance:none; background:var(--card); color:var(--ink);
    border:1px solid var(--line); border-radius:12px;
    padding:10px 14px; cursor:pointer; font-weight:600;
    transition:background .15s ease,border-color .15s ease,transform .06s ease;
  }
  button:hover,.chip:hover{background:var(--bg2); border-color:var(--muted)}
  button:active,.chip:active{transform:translateY(1px)}
  button.primary{background:var(--accent); border-color:var(--accent); color:#000; font-weight:700}
  button.primary:hover{filter:brightness(1.1)}
  button.danger{background:var(--danger); border-color:var(--danger); color:#000}
  button.ghost{background:transparent}
  .presets .chip.active{background:var(--accent-2); border-color:var(--accent-2); color:#000}
  input[type="text"],input[type="number"],textarea{
    width:100%; padding:12px 14px; border-radius:12px;
    background:var(--bg2); color:var(--ink); border:1px solid var(--line); outline:none;
    transition:border-color .2s ease, box-shadow .2s ease;
  }
  input[type="text"]:focus,input[type="number"]:focus,textarea:focus{
    border-color:var(--accent); box-shadow:0 0 0 3px rgba(0,194,111,.2);
  }
  .grid{display:grid; grid-template-columns:1.4fr 1fr; gap:18px}
  @media (max-width:1000px){ .grid{grid-template-columns:1fr} }
  .taskRow{display:grid; grid-template-columns:1fr auto; gap:8px; margin-top:8px}
  .taskItem{
    display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:10px;
    padding:10px 12px; border-radius:12px; background:var(--bg2); border:1px solid var(--line);
    transition:background .2s ease, border-color .2s ease;
  }
  .taskItem.done{opacity:.6; text-decoration:line-through}
  .checkbox{width:18px;height:18px;accent-color:var(--accent)}
  .muted{color:var(--muted);font-size:13px}
  .small{font-size:12px}
  .tog{display:inline-flex;align-items:center;gap:8px}
  a.link{color:var(--accent);text-decoration:none;border-bottom:1px dashed rgba(0,194,111,.5)}
  footer{color:var(--muted);text-align:center;font-size:12px}

  /* Quote Section */
  .quoteJokeRow {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 18px;
  }
  @media (max-width: 880px) {
    .quoteJokeRow {
      grid-template-columns: 1fr;
    }
  }
  .quoteCard, .jokeCard {
    text-align: center;
    padding: 24px;
  }
  .quoteText {
    font-size: 18px;
    font-weight: 600;
    font-style: italic;
    line-height: 1.6;
    color: var(--ink);
    margin-bottom: 12px;
  }
  .quoteAuthor {
    color: var(--muted);
    font-size: 14px;
    margin-bottom: 16px;
  }
  .newQuoteBtn, .newJokeBtn {
    font-size: 13px;
    padding: 8px 16px;
  }
  .jokeText {
    font-size: 16px;
    line-height: 1.6;
    color: var(--ink);
    margin-bottom: 16px;
    min-height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Tabs */
  .tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 22px;
    border-bottom: 2px solid var(--line);
    padding-bottom: 0;
  }
  .tab {
    padding: 12px 24px;
    background: transparent;
    border: none;
    border-bottom: 3px solid transparent;
    color: var(--muted);
    cursor: pointer;
    font-weight: 600;
    font-size: 15px;
    transition: all 0.2s ease;
    margin-bottom: -2px;
  }
  .tab:hover {
    color: var(--ink);
    background: rgba(255, 255, 255, 0.03);
  }
  .tab.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
  }
  .tabContent {
    display: none;
  }
  .tabContent.active {
    display: grid;
    gap: 22px;
  }

  /* Games */
  .gamesGrid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 18px;
  }
  @media (max-width: 880px) {
    .gamesGrid {
      grid-template-columns: 1fr;
    }
  }
  .gameCard {
    padding: 24px;
    min-height: 300px;
    display: flex;
    flex-direction: column;
  }
  .gameTitle {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 8px;
  }
  .gameDesc {
    color: var(--muted);
    font-size: 13px;
    margin-bottom: 16px;
  }
  .gameArea {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 16px;
  }

  /* Memory Game */
  .memoryGrid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    max-width: 280px;
  }
  .memoryCard {
    aspect-ratio: 1;
    background: var(--card);
    border: 2px solid var(--line);
    border-radius: 8px;
    cursor: pointer;
    display: grid;
    place-items: center;
    font-size: 24px;
    transition: all 0.3s ease;
  }
  .memoryCard:hover:not(.flipped):not(.matched) {
    background: var(--bg2);
    transform: scale(1.05);
    border-color: var(--accent);
  }
  .memoryCard.flipped, .memoryCard.matched {
    background: var(--accent-2);
    border-color: var(--accent);
  }
  .memoryCard.matched {
    opacity: 0.6;
  }

  /* Reaction Game */
  .reactionBox {
    width: 100%;
    max-width: 300px;
    height: 200px;
    background: var(--card);
    border: 2px solid var(--line);
    border-radius: 12px;
    display: grid;
    place-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    padding: 20px;
  }
  .reactionBox.waiting {
    background: var(--danger);
    border-color: var(--danger);
  }
  .reactionBox.ready {
    background: var(--accent);
    border-color: var(--accent);
    color: #000;
  }
  .reactionBox:hover {
    transform: scale(1.02);
  }
  .reactionScore {
    font-size: 14px;
    color: var(--muted);
  }

  /* AI Tools Shortcuts */
  .aiShortcut {
    text-decoration: none;
    color: inherit;
  }
  .aiShortcut .card {
    padding: 28px;
    cursor: pointer;
    transition: transform 0.2s ease, border-color 0.2s ease;
  }
  .aiShortcut .card:hover {
    transform: translateY(-4px);
    border-color: var(--accent);
  }
  .aiToolsGrid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 18px;
    max-width: 600px;
    margin: 0 auto;
  }
  @media (max-width: 600px) {
    .aiToolsGrid {
      grid-template-columns: 1fr;
    }
  }

  /* Enhanced Mobile Responsiveness */
  @media (max-width: 600px) {
    body {
      padding: 16px;
    }
    .app {
      gap: 16px;
    }
    header {
      flex-direction: column;
      align-items: flex-start;
      gap: 16px;
    }
    .title {
      font-size: 22px;
    }
    .sub {
      font-size: 13px;
    }
    .card {
      padding: 16px;
    }
    .tabs {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    .tab {
      padding: 10px 16px;
      font-size: 14px;
      white-space: nowrap;
    }
    .ringWrap svg {
      width: 220px;
      height: 220px;
    }
    .time {
      font-size: 42px;
    }
    .controls, .presets {
      gap: 8px;
    }
    button, .chip {
      padding: 8px 12px;
      font-size: 14px;
    }
    .memoryGrid {
      gap: 8px;
      max-width: 240px;
    }
    .memoryCard {
      font-size: 20px;
    }
    .reactionBox {
      height: 160px;
      font-size: 16px;
      padding: 16px;
    }
    .gameTitle {
      font-size: 18px;
    }
    .gameCard {
      padding: 16px;
      min-height: 250px;
    }
    #customMins {
    
    }
  }

  @media (max-width: 400px) {
    .presets {
      flex-direction: column;
      align-items: stretch;
    }
    .chip, button {
      width: 100%;
      text-align: center;
    }
    .controls {
      flex-direction: column;
      align-items: stretch;
    }
  }

  /* Enhanced Visual Feedback & Animations */
  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
  }

  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
  }

  @keyframes success {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); background: var(--accent); }
    100% { transform: scale(1); }
  }

  /* Apply animations to elements */
  .taskItem {
    animation: slideIn 0.3s ease;
  }

  button.primary:active {
    animation: pulse 0.3s ease;
  }

  .taskItem:hover {
    border-color: var(--accent);
    transform: translateX(4px);
  }

  .chip:active, button:active {
    transform: translateY(2px) scale(0.98);
  }

  /* Tab switching animation */
  .tabContent.active {
    animation: fadeIn 0.4s ease;
  }

  /* Theme toggle pulse */
  #themeToggle:active {
    animation: pulse 0.2s ease;
  }

  /* Add ripple effect class for JavaScript */
  .ripple {
    position: relative;
    overflow: hidden;
  }

  .ripple::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.5);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
  }

  .ripple:active::after {
    width: 200px;
    height: 200px;
  }

  /* Success state for task completion */
  .taskItem.done {
    animation: success 0.5s ease;
  }

  /* Focus states */
  button:focus-visible, .chip:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }

  input:focus-visible, textarea:focus-visible {
    outline: none;
  }

  /* Smooth scrolling */
  html {
    scroll-behavior: smooth;
  }
</style>
</head>
<body>
  <div class="app">
    <header>
      <div>
        <div class="title">Focus Timer + Quick Tasks</div>
        <div class="sub">A no-login, one-page productivity tool. Your data saves in your browser.</div>
      </div>
      <div style="display: flex; gap: 16px; align-items: center; flex-wrap: wrap;">
        <button id="themeToggle" class="ghost" style="padding: 8px 14px;">
          <span id="themeIcon">ðŸŒ™</span>
        </button>
        <div class="tog">
          <input id="soundToggle" type="checkbox" />
          <label for="soundToggle" class="small">Chime on session end</label>
        </div>
      </div>
    </header>

    <!-- Tab Navigation -->
    <div class="tabs">
      <button class="tab active" data-tab="focus">Focus & Productivity</button>
      <button class="tab" data-tab="games">Mini Games</button>
      <button class="tab" data-tab="ai">AI Tools</button>
    </div>

    <!-- Focus Tab Content -->
    <div id="focusTab" class="tabContent active">
      <div class="quoteJokeRow">
      <section class="card quoteCard">
        <div class="quoteText" id="quoteText">"The secret of getting ahead is getting started."</div>
        <div class="quoteAuthor" id="quoteAuthor">â€” Mark Twain</div>
        <button class="ghost newQuoteBtn" id="newQuoteBtn">New Quote</button>
      </section>

      <section class="card jokeCard">
        <div class="jokeText" id="jokeText">Why don't programmers like nature? It has too many bugs!</div>
        <button class="ghost newJokeBtn" id="newJokeBtn">New Joke</button>
      </section>
    </div>

    <section class="card timer">
      <div class="ringWrap">
        <svg width="260" height="260" viewBox="0 0 120 120" style="position: relative;">
          <circle cx="60" cy="60" r="52" stroke="rgba(255,255,255,.12)" stroke-width="8" fill="none"/>
          <circle id="progress" cx="60" cy="60" r="52" stroke="url(#g)" stroke-width="8" stroke-linecap="round" fill="none"
                  transform="rotate(-90 60 60)" stroke-dasharray="327" stroke-dashoffset="327"/>
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#7c5cff"></stop>
              <stop offset="100%" stop-color="#33d6a6"></stop>
            </linearGradient>
          </defs>
        </svg>
        <div class="time" id="time">25:00</div>
      </div>

      <div>
        <div class="presets" style="margin-bottom:12px;">
          <button class="chip active" data-mins="25">Pomodoro 25</button>
          <button class="chip" data-mins="5">Short Break 5</button>
          <button class="chip" data-mins="15">Long Break 15</button>
          <span class="spacer"></span>
          <label class="muted small">Custom:</label>
          <input id="customMins" type="number" min="1" max="180" value="25" style="width:84px;" />
          <button class="chip" id="applyCustom">Set</button>
        </div>
        <div class="controls" style="margin-bottom:12px;">
          <button id="startBtn" class="primary">Start</button>
          <button id="pauseBtn" class="ghost">Pause</button>
          <button id="resetBtn" class="danger">Reset</button>
        </div>
        <div class="muted small">
          Tip: switch presets anytimeâ€”progress resets to match the selected length.
        </div>
      </div>
    </section>

    <section class="grid">
      <div class="card">
        <strong>Quick Tasks</strong>
        <div class="taskRow">
          <input id="taskInput" type="text" placeholder="Add a task and press Enterâ€¦" />
          <button id="addTask">Add</button>
        </div>
        <div id="taskList" style="display:grid; gap:8px; margin-top:12px;"></div>
        <div class="foot">
          <span class="muted small">Tasks save automatically.</span>
          <div>
            <button id="clearDone" class="ghost small">Clear done</button>
            <button id="clearAll" class="ghost small">Clear all</button>
          </div>
        </div>
      </div>

      <div class="card">
        <strong>Session Notes</strong>
        <textarea id="notes" rows="9" placeholder="Jot down what you're focusing onâ€¦"></textarea>
        <div class="foot">
          <span class="muted small">Notes auto-save locally.</span>
          <a id="downloadNotes" href="#" class="link small">Download .txt</a>
        </div>
        <div class="muted small warn">No accounts, no tracking, just your browser.</div>
      </div>
    </section>
    </div>

    <!-- Games Tab Content -->
    <div id="gamesTab" class="tabContent">
      <div class="gamesGrid">
        <!-- Memory Card Game -->
        <section class="card gameCard">
          <div class="gameTitle">Memory Match</div>
          <div class="gameDesc">Find all matching pairs of emojis</div>
          <div class="gameArea">
            <div class="memoryGrid" id="memoryGrid"></div>
            <div>
              <div class="reactionScore">Moves: <span id="memoryMoves">0</span> | Matches: <span id="memoryMatches">0</span>/8</div>
              <button class="ghost small" id="resetMemory" style="margin-top: 12px;">Reset Game</button>
            </div>
          </div>
        </section>

        <!-- Reaction Time Game -->
        <section class="card gameCard">
          <div class="gameTitle">Reaction Timer</div>
          <div class="gameDesc">Test your reaction speed!</div>
          <div class="gameArea">
            <div class="reactionBox" id="reactionBox">
              Click to Start
            </div>
            <div class="reactionScore">
              <div id="reactionResult">Best Time: <span id="bestTime">-</span>ms</div>
              <div style="margin-top: 4px; font-size: 12px;">Average: <span id="avgTime">-</span>ms</div>
            </div>
          </div>
        </section>
      </div>
    </div>

    <!-- AI Tools Tab Content -->
    <div id="aiTab" class="tabContent">
      <section class="card" style="text-align: center; padding: 32px;">
        <h2 style="font-size: 24px; font-weight: 700; margin-bottom: 12px;">AI Shortcuts</h2>
        <p style="color: var(--muted); margin-bottom: 32px;">Quick access to AI assistants</p>

        <div class="aiToolsGrid">
          <!-- Claude Shortcut -->
          <a href="https://claude.ai" target="_blank" rel="noopener noreferrer" class="aiShortcut">
            <div class="card">
              <div style="font-size: 48px; margin-bottom: 12px;">ðŸ¤–</div>
              <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">Claude</div>
              <div style="color: var(--muted); font-size: 14px;">Anthropic's AI assistant</div>
            </div>
          </a>

          <!-- ChatGPT Shortcut -->
          <a href="https://chat.openai.com" target="_blank" rel="noopener noreferrer" class="aiShortcut">
            <div class="card">
              <div style="font-size: 48px; margin-bottom: 12px;">ðŸ’¬</div>
              <div style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">ChatGPT</div>
              <div style="color: var(--muted); font-size: 14px;">OpenAI's conversational AI</div>
            </div>
          </a>
        </div>

        <p style="color: var(--muted); font-size: 13px; margin-top: 32px;">
          Links open in new tabs so you can keep your timer running
        </p>
      </section>
    </div>

  </div>

<script>
(() => {
  // ---------- Utilities ----------
  const $ = (sel, ctx=document) => ctx.querySelector(sel);
  const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));
  const store = {
    get(key, fallback) {
      try { return JSON.parse(localStorage.getItem(key)) ?? fallback; }
      catch { return fallback; }
    },
    set(key, val) { localStorage.setItem(key, JSON.stringify(val)); }
  };

  // ---------- Theme Toggle ----------
  const themeToggle = $('#themeToggle');
  const themeIcon = $('#themeIcon');
  const savedTheme = store.get('theme', 'dark');

  function setTheme(theme) {
    document.documentElement.setAttribute('data-theme', theme);
    themeIcon.textContent = theme === 'light' ? 'â˜€ï¸' : 'ðŸŒ™';
    store.set('theme', theme);
  }

  setTheme(savedTheme);

  themeToggle.addEventListener('click', () => {
    const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
    const newTheme = currentTheme === 'light' ? 'dark' : 'light';
    setTheme(newTheme);
  });

  // ---------- Visual Feedback Enhancements ----------
  // Add ripple effect to all buttons
  $$('button, .chip').forEach(btn => {
    btn.classList.add('ripple');
  });

  // Show success toast notification
  function showToast(message, type = 'success') {
    const toast = document.createElement('div');
    toast.style.cssText = `
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: ${type === 'success' ? 'var(--accent)' : 'var(--danger)'};
      color: #000;
      padding: 12px 20px;
      border-radius: 12px;
      font-weight: 600;
      font-size: 14px;
      box-shadow: var(--shadow);
      z-index: 1000;
      animation: slideIn 0.3s ease;
      max-width: 300px;
    `;
    toast.textContent = message;
    document.body.appendChild(toast);

    setTimeout(() => {
      toast.style.animation = 'fadeOut 0.3s ease';
      toast.style.opacity = '0';
      setTimeout(() => toast.remove(), 300);
    }, 3000);
  }

  // Add visual feedback when timer completes
  const originalChime = window.chime;

  // ---------- Timer State ----------
  let totalSecs = 25*60;
  let remaining = totalSecs;
  let tickId = null;
  const ring = $('#progress');
  const timeEl = $('#time');
  const dash = 2 * Math.PI * 52; // circumference â‰ˆ 327
  ring.setAttribute('stroke-dasharray', dash);

  function format(ms) {
    const m = Math.floor(ms/60);
    const s = ms % 60;
    return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  }
  function render() {
    timeEl.textContent = format(remaining);
    const ratio = 1 - (remaining / totalSecs);
    ring.setAttribute('stroke-dashoffset', String((1 - ratio) * dash));
  }
  function setLength(mins) {
    mins = Math.max(1, Math.min(180, Number(mins)||25));
    totalSecs = mins * 60;
    remaining = totalSecs;
    render();
    $('#customMins').value = mins;
    $$('.presets .chip').forEach(c => c.classList.toggle('active', c.dataset.mins == mins));
    pause();
  }
  function start() {
    if (tickId) return;
    const startAt = Date.now();
    let last = startAt;
    tickId = setInterval(() => {
      const now = Date.now();
      const delta = Math.floor((now - last)/1000);
      if (delta >= 1) {
        remaining = Math.max(0, remaining - delta);
        last = now;
        render();
        if (remaining <= 0) {
          pause();
          chime();
          showToast('ðŸŽ‰ Focus session complete!', 'success');
        }
      }
    }, 250);
  }
  function pause() { clearInterval(tickId); tickId = null; }
  function reset() { remaining = totalSecs; render(); pause(); }
  function chime() {
    if (!$('#soundToggle').checked) return;
    try {
      const ctx = new (window.AudioContext || window.webkitAudioContext)();
      const o = ctx.createOscillator(); const g = ctx.createGain();
      o.type = "sine"; o.frequency.value = 880;
      o.connect(g); g.connect(ctx.destination);
      g.gain.setValueAtTime(0.001, ctx.currentTime);
      g.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime + 0.02);
      g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 1.0);
      o.start(); o.stop(ctx.currentTime + 1.0);
    } catch {}
  }

  // ---------- Presets ----------
  $$('.presets .chip[data-mins]').forEach(btn => {
    btn.addEventListener('click', () => setLength(Number(btn.dataset.mins)));
  });
  $('#applyCustom').addEventListener('click', () => setLength($('#customMins').value));
  $('#startBtn').addEventListener('click', start);
  $('#pauseBtn').addEventListener('click', pause);
  $('#resetBtn').addEventListener('click', reset);

  // ---------- Tasks ----------
  function renderTasks() {
    const tasks = store.get('tasks', []);
    const list = $('#taskList');
    list.innerHTML = '';
    tasks.forEach((t, i) => {
      const row = document.createElement('div'); row.className = 'taskItem' + (t.done?' done':'');
      const cb = document.createElement('input'); cb.type = 'checkbox'; cb.className='checkbox'; cb.checked = !!t.done;
      cb.addEventListener('change', () => { tasks[i].done = cb.checked; store.set('tasks', tasks); renderTasks(); });
      const label = document.createElement('div'); label.textContent = t.text;
      const del = document.createElement('button'); del.className='ghost small'; del.textContent='Delete';
      del.addEventListener('click', () => { tasks.splice(i,1); store.set('tasks', tasks); renderTasks(); });
      row.append(cb, label, del);
      list.append(row);
    });
  }
  function addTaskFromInput() {
    const v = $('#taskInput').value.trim();
    if (!v) return;
    const tasks = store.get('tasks', []);
    tasks.unshift({ text: v, done: false });
    store.set('tasks', tasks);
    $('#taskInput').value = '';
    renderTasks();
    showToast('âœ“ Task added', 'success');
  }
  $('#addTask').addEventListener('click', addTaskFromInput);
  $('#taskInput').addEventListener('keydown', e => { if (e.key === 'Enter') addTaskFromInput(); });
  $('#clearDone').addEventListener('click', () => {
    const before = store.get('tasks', []).length;
    const tasks = store.get('tasks', []).filter(t => !t.done);
    store.set('tasks', tasks);
    renderTasks();
    const removed = before - tasks.length;
    if (removed > 0) showToast(`ðŸ—‘ï¸ Cleared ${removed} completed task${removed > 1 ? 's' : ''}`, 'success');
  });
  $('#clearAll').addEventListener('click', () => {
    if (!confirm('Clear ALL tasks?')) return;
    const count = store.get('tasks', []).length;
    store.set('tasks', []);
    renderTasks();
    if (count > 0) showToast(`ðŸ—‘ï¸ Cleared ${count} task${count > 1 ? 's' : ''}`, 'success');
  });

  // ---------- Notes ----------
  const notes = $('#notes');
  notes.value = store.get('notes', '');
  notes.addEventListener('input', () => store.set('notes', notes.value));
  $('#downloadNotes').addEventListener('click', (e) => {
    e.preventDefault();
    if (!notes.value.trim()) {
      showToast('âš ï¸ No notes to download', 'danger');
      return;
    }
    const blob = new Blob([notes.value], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = `focus-notes-${new Date().toISOString().slice(0,10)}.txt`;
    document.body.appendChild(a); a.click(); a.remove();
    setTimeout(() => URL.revokeObjectURL(url), 500);
    showToast('ðŸ“¥ Notes downloaded', 'success');
  });

  // ---------- Settings ----------
  const saved = store.get('settings', { mins: 25, sound: false });
  $('#soundToggle').checked = !!saved.sound;
  setLength(saved.mins || 25);
  renderTasks();
  render();

  // Persist some state when leaving
  window.addEventListener('beforeunload', () => {
    store.set('settings', { mins: totalSecs/60, sound: $('#soundToggle').checked });
  });

  // ---------- Random Quote Generator ----------
  const quotes = [
    { text: "The secret of getting ahead is getting started.", author: "Mark Twain" },
    { text: "It does not matter how slowly you go as long as you do not stop.", author: "Confucius" },
    { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
    { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
    { text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
    { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
    { text: "The future depends on what you do today.", author: "Mahatma Gandhi" },
    { text: "Focus on being productive instead of busy.", author: "Tim Ferriss" },
    { text: "You don't have to be great to start, but you have to start to be great.", author: "Zig Ziglar" },
    { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" },
    { text: "Productivity is never an accident. It is always the result of a commitment to excellence.", author: "Paul J. Meyer" },
    { text: "Concentrate all your thoughts upon the work in hand. The sun's rays do not burn until brought to a focus.", author: "Alexander Graham Bell" },
    { text: "You may delay, but time will not.", author: "Benjamin Franklin" },
    { text: "Action is the foundational key to all success.", author: "Pablo Picasso" },
    { text: "The only limit to our realization of tomorrow will be our doubts of today.", author: "Franklin D. Roosevelt" },
    { text: "Start where you are. Use what you have. Do what you can.", author: "Arthur Ashe" },
    { text: "Either you run the day or the day runs you.", author: "Jim Rohn" },
    { text: "Time is what we want most, but what we use worst.", author: "William Penn" },
    { text: "The key is not to prioritize what's on your schedule, but to schedule your priorities.", author: "Stephen Covey" },
    { text: "Amateurs sit and wait for inspiration, the rest of us just get up and go to work.", author: "Stephen King" }
  ];

  const quoteText = $('#quoteText');
  const quoteAuthor = $('#quoteAuthor');
  const newQuoteBtn = $('#newQuoteBtn');

  function displayRandomQuote() {
    const randomIndex = Math.floor(Math.random() * quotes.length);
    const quote = quotes[randomIndex];
    quoteText.textContent = `"${quote.text}"`;
    quoteAuthor.textContent = `â€” ${quote.author}`;
  }

  newQuoteBtn.addEventListener('click', displayRandomQuote);

  // ---------- Random Joke Generator ----------
  const jokes = [
    "Why don't programmers like nature? It has too many bugs!",
    "Why did the developer go broke? Because he used up all his cache!",
    "How many programmers does it take to change a light bulb? None, that's a hardware problem.",
    "Why do Java developers wear glasses? Because they don't C#!",
    "What's a programmer's favorite hangout place? The Foo Bar!",
    "Why did the scarecrow win an award? He was outstanding in his field!",
    "What do you call a bear with no teeth? A gummy bear!",
    "Why don't scientists trust atoms? Because they make up everything!",
    "What did the ocean say to the beach? Nothing, it just waved!",
    "Why did the bicycle fall over? It was two-tired!",
    "What do you call fake spaghetti? An impasta!",
    "How does a penguin build its house? Igloos it together!",
    "Why don't eggs tell jokes? They'd crack each other up!",
    "What do you call a fish wearing a bowtie? Sofishticated!",
    "Why did the math book look so sad? Because it had too many problems!",
    "What do you call a can opener that doesn't work? A can't opener!",
    "Why did the coffee file a police report? It got mugged!",
    "What's the best time to go to the dentist? Tooth hurty!",
    "Why don't skeletons fight each other? They don't have the guts!",
    "What did one wall say to the other wall? I'll meet you at the corner!"
  ];

  const jokeText = $('#jokeText');
  const newJokeBtn = $('#newJokeBtn');

  function displayRandomJoke() {
    const randomIndex = Math.floor(Math.random() * jokes.length);
    jokeText.textContent = jokes[randomIndex];
  }

  newJokeBtn.addEventListener('click', displayRandomJoke);

  // ---------- Tab Switching ----------
  const tabs = $$('.tab');
  const tabContents = $$('.tabContent');

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      const targetTab = tab.dataset.tab;

      // Update active tab
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');

      // Update active content
      tabContents.forEach(content => content.classList.remove('active'));
      const targetContent = $(`#${targetTab}Tab`);
      if (targetContent) targetContent.classList.add('active');
    });
  });

  // ---------- Memory Card Game ----------
  const emojis = ['ðŸŽ®', 'ðŸŽ¯', 'ðŸŽ¨', 'ðŸŽ­', 'ðŸŽª', 'ðŸŽ¸', 'ðŸŽº', 'ðŸŽ»'];
  let memoryCards = [];
  let flippedCards = [];
  let matchedPairs = 0;
  let moves = 0;

  function initMemoryGame() {
    const memoryGrid = $('#memoryGrid');
    memoryGrid.innerHTML = '';

    // Create pairs and shuffle
    memoryCards = [...emojis, ...emojis]
      .sort(() => Math.random() - 0.5)
      .map((emoji, index) => ({ emoji, index, matched: false }));

    // Create card elements
    memoryCards.forEach((card, i) => {
      const cardEl = document.createElement('div');
      cardEl.className = 'memoryCard';
      cardEl.dataset.index = i;
      cardEl.addEventListener('click', () => flipCard(i, cardEl));
      memoryGrid.appendChild(cardEl);
    });

    flippedCards = [];
    matchedPairs = 0;
    moves = 0;
    updateMemoryScore();
  }

  function flipCard(index, cardEl) {
    if (flippedCards.length >= 2 || cardEl.classList.contains('flipped') || cardEl.classList.contains('matched')) {
      return;
    }

    cardEl.classList.add('flipped');
    cardEl.textContent = memoryCards[index].emoji;
    flippedCards.push({ index, cardEl });

    if (flippedCards.length === 2) {
      moves++;
      updateMemoryScore();

      setTimeout(() => {
        const [first, second] = flippedCards;

        if (memoryCards[first.index].emoji === memoryCards[second.index].emoji) {
          // Match found
          first.cardEl.classList.add('matched');
          second.cardEl.classList.add('matched');
          memoryCards[first.index].matched = true;
          memoryCards[second.index].matched = true;
          matchedPairs++;
          updateMemoryScore();

          if (matchedPairs === emojis.length) {
            setTimeout(() => alert(`You won in ${moves} moves!`), 300);
          }
        } else {
          // No match
          first.cardEl.classList.remove('flipped');
          second.cardEl.classList.remove('flipped');
          first.cardEl.textContent = '';
          second.cardEl.textContent = '';
        }

        flippedCards = [];
      }, 800);
    }
  }

  function updateMemoryScore() {
    $('#memoryMoves').textContent = moves;
    $('#memoryMatches').textContent = matchedPairs;
  }

  $('#resetMemory')?.addEventListener('click', initMemoryGame);
  initMemoryGame();

  // ---------- Reaction Time Game ----------
  let reactionState = 'idle';
  let reactionStartTime = 0;
  let reactionTimeout = null;
  let reactionTimes = [];
  let bestReactionTime = Infinity;

  const reactionBox = $('#reactionBox');

  function startReaction() {
    if (reactionState !== 'idle') return;

    reactionState = 'waiting';
    reactionBox.textContent = 'Wait for green...';
    reactionBox.classList.add('waiting');
    reactionBox.classList.remove('ready');

    // Random delay between 2-5 seconds
    const delay = 2000 + Math.random() * 3000;

    reactionTimeout = setTimeout(() => {
      reactionState = 'ready';
      reactionBox.textContent = 'CLICK NOW!';
      reactionBox.classList.remove('waiting');
      reactionBox.classList.add('ready');
      reactionStartTime = Date.now();
    }, delay);
  }

  function handleReactionClick() {
    if (reactionState === 'idle') {
      startReaction();
    } else if (reactionState === 'waiting') {
      // Clicked too early
      clearTimeout(reactionTimeout);
      reactionState = 'idle';
      reactionBox.classList.remove('waiting');
      reactionBox.textContent = 'Too early! Click to try again';
    } else if (reactionState === 'ready') {
      // Calculate reaction time
      const reactionTime = Date.now() - reactionStartTime;
      reactionTimes.push(reactionTime);

      if (reactionTime < bestReactionTime) {
        bestReactionTime = reactionTime;
      }

      // Calculate average
      const avg = Math.round(reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length);

      reactionState = 'idle';
      reactionBox.classList.remove('ready');
      reactionBox.textContent = `${reactionTime}ms! Click to try again`;

      $('#bestTime').textContent = bestReactionTime;
      $('#avgTime').textContent = avg;
    }
  }

  reactionBox?.addEventListener('click', handleReactionClick);
})();
</script>
</body>
</html>

